# v1 Spec — Home Inventory Chip (Pads)

## Overview
v1 is an **8-channel pad-based** inventory sensing demo. Each pad corresponds to a bin/container location. The chip is **digital-only** and reads pad measurements via an **off-chip multi-channel load-cell ADC**; the chip processes events and exposes data to a host.

## Goals
- Detect weight-change events with an effective target resolution of **~20 g** per channel (after calibration/filtering).
- Primary UX: **add/remove events** (not absolute weight readout).
- Demo hardware assumption: **one ~10" smart shelf with a single load cell**; max load **1 kg**, typical tare **~100 g**, typical item **~300 g jars**.
- Support **8 independent channels**.
- Demonstrate a practical “home inventory” flow: add/remove detection + per-bin totals.

## Definition: “~20 g effective resolution”

This project target is *system-level*, not an ADC LSB claim. For v1, we will treat a channel as meeting the **~20 g effective resolution** goal if all of the following are true after tare + the nominal digital filter, under a controlled bench setup:

1) **Noise (short-term):** with a constant load, the reported weight has
   - RMS noise ≤ **8 g** over a **10 s** window, and
   - peak-to-peak noise ≤ **±20 g** over the same window.

2) **Step detectability:** a **+20 g** and **−20 g** step applied to the pad produces the correct add/remove event with
   - ≥ **95% probability** within **≤ 2 s**,
   - and no more than **1 false event/hour** when the load is constant.

3) **Drift (medium-term):** with constant load and stable temperature, the reported weight drifts by
   - ≤ **±20 g** over **30 minutes** after an initial 2-minute settling period.

4) **Crosstalk limit:** a step on channel *i* must not induce a spurious event on channel *j≠i* in the same 2 s window (for the bench fixture / mechanical isolation used in the demo).

Notes:
- These numbers are intentionally conservative placeholders; we can tighten/adjust once the ADC part + sampling rate is locked.
- The verification plan will carry *digital* checks; these acceptance criteria are for bring-up/bench validation (firmware + hardware).

## Bench procedure (v1)

A minimal repeatable procedure we can run during bring-up:
- Tare each channel with the pad empty.
- Record 10 s of samples per channel (constant load) to compute RMS + p2p.
- Apply known step weights (20 g, 50 g) and measure detection latency + false positives.
- Leave the system running for 30 minutes to measure drift.

## Non-goals (v1)
- On-chip analog front-end / ADC.
- Battery power optimization.
- RF / wireless connectivity on-chip.

## System architecture (high level)
- **Sensors:** 8 load cells (or equivalent) under 8 pads.
- **ADC:** 1 external multi-channel load-cell ADC (8ch).
- **Chip (digital):** small RISC-V SoC (or minimal MCU-class core) + peripheral bus.
- **Peripherals (chip):**
  - SPI (primary) for ADC readout (or I2C if we pick an ADC that prefers it)
  - UART for debug/bring-up
  - Optional: GPIOs for status/interrupts
  - Optional: PWM/timers for simple indicators

## Data model
Per channel (0..7):
- raw_sample (from ADC)
- calibrated_weight_g (fixed-point)
- baseline / tare
- event stream: {timestamp, delta_g, type(add/remove)}

## Calibration & filtering
- Per-channel tare/baseline capture.
- Simple digital filtering (moving average / IIR) to reduce noise.
- Event detection with hysteresis and minimum-duration qualification.
  - Default thresholds: **ADD at +25 g**, **REMOVE at −25 g** (Decision 003).

## Acceptance tests (v1)
1) **Enumerate channels:** firmware can read all 8 channels and report values.
2) **Calibration:** per-channel tare reduces static offset to within an acceptable threshold.
3) **Event detect:** step changes of ~20 g produce add/remove events reliably in controlled conditions.
4) **No crosstalk:** activity on one channel does not create false events on others beyond a defined limit.
5) **Telemetry:** host can query per-channel latest weight + event counters.

## Open questions (owned by Madhuri)
- **ADC choice:** locked to **TI ADS131M08 over SPI** (see `decisions/008-adc-part-selection.md`).
  - Interface contract draft: `spec/ads131m08_interface.md`
  - Firmware init sequence: `docs/ADC_FW_INIT_SEQUENCE.md`
- Threshold defaults (hysteresis, debounce) once ADC sampling rate is known. See `decisions/003-event-threshold-hysteresis.md` and fixed-point conventions in `spec/fixed_point.md`.
- Decide if the host interface is UART-only or UART+SPI (what the harness expects for the demo).
